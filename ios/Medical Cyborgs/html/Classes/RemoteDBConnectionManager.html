<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="html/html; charset=utf-8" />
		<title>RemoteDBConnectionManager Class Reference</title>
		<meta id="xcode-display" name="xcode-display" content="render"/>
		<link rel="stylesheet" type="text/css" href="../css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="../css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.2 (build 963)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="../index.html">Medical Cyborgs </a></h1>
				<a id="developerHome" href="../index.html">UHCL</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode">RemoteDBConnectionManager Class Reference</h1>
			</div>
			<ul id="headerButtons" role="toolbar">
				<li id="toc_button">
					<button aria-label="Show Table of Contents" role="checkbox" class="open" id="table_of_contents"><span class="disclosure"></span>Table of Contents</button>
				</li>
				<li id="jumpto_button" role="navigation">
					<select id="jumpTo">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	
	
	
	
	<option value="tasks">Tasks</option>
	
	
	
	
	
	<option value="properties">Properties</option>
	
	<option value="//api/name/_serverResponseData">&nbsp;&nbsp;&nbsp;&nbsp;_serverResponseData</option>
	
	<option value="//api/name/currentRow">&nbsp;&nbsp;&nbsp;&nbsp;currentRow</option>
	
	<option value="//api/name/database">&nbsp;&nbsp;&nbsp;&nbsp;database</option>
	
	<option value="//api/name/failedAttempts">&nbsp;&nbsp;&nbsp;&nbsp;failedAttempts</option>
	
	<option value="//api/name/patientID">&nbsp;&nbsp;&nbsp;&nbsp;patientID</option>
	
	<option value="//api/name/remoteUnreachable">&nbsp;&nbsp;&nbsp;&nbsp;remoteUnreachable</option>
	
	
	
	
	
	
	<option value="instance_methods">Instance Methods</option>
	
	<option value="//api/name/URLEncodedString:">&nbsp;&nbsp;&nbsp;&nbsp;- URLEncodedString:</option>
	
	<option value="//api/name/initWithDatabase:">&nbsp;&nbsp;&nbsp;&nbsp;- initWithDatabase:</option>
	
	<option value="//api/name/pushDataToRemoteServer">&nbsp;&nbsp;&nbsp;&nbsp;- pushDataToRemoteServer</option>
	
	<option value="//api/name/removeCurrentRowInLocalDB">&nbsp;&nbsp;&nbsp;&nbsp;- removeCurrentRowInLocalDB</option>
	
	<option value="//api/name/sendRowToServer">&nbsp;&nbsp;&nbsp;&nbsp;- sendRowToServer</option>
	
	
	
</select>
				</li>
			</ul>
		</header>
		<nav id="tocContainer" class="isShowingTOC">
			<ul id="toc" role="tree">
				
<li role="treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#overview">Overview</a></span></li>




<li role="treeitem" id="task_treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#tasks">Tasks</a></span><ul>
	
</ul></li>





<li role="treeitem" class="children"><span class="disclosure"></span><span class="sectionName"><a href="#properties">Properties</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/_serverResponseData">_serverResponseData</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/currentRow">currentRow</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/database">database</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/failedAttempts">failedAttempts</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/patientID">patientID</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/remoteUnreachable">remoteUnreachable</a></span></li>
	
</ul></li>





<li role="treeitem" class="children"><span class="disclosure"></span><span class="sectionName"><a href="#instance_methods">Instance Methods</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/URLEncodedString:">URLEncodedString:</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/initWithDatabase:">initWithDatabase:</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/pushDataToRemoteServer">pushDataToRemoteServer</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/removeCurrentRowInLocalDB">removeCurrentRowInLocalDB</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/sendRowToServer">sendRowToServer</a></span></li>
	
</ul></li>


			</ul>
		</nav>
		<article>
			<div id="contents" class="isShowingTOC" role="main">
				<a title="RemoteDBConnectionManager Class Reference" name="top"></a>
				<div class="main-navigation navigation-top">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="header">
					<div class="section-header">
						<h1 class="title title-header">RemoteDBConnectionManager Class Reference</h1>
					</div>		
				</div>
				<div id="container">	
					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<td class="specification-title">Inherits from</td>
	<td class="specification-value">NSObject</td>
</tr><tr>
	<td class="specification-title">Conforms to</td>
	<td class="specification-value">NSURLSessionDelegate</td>
</tr><tr>
	<td class="specification-title">Declared in</td>
	<td class="specification-value">RemoteDBConnectionManager.h</td>
</tr>
						</tbody></table></div>
					
                    
                    
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p>This class performs updates to the remote <a href="#//api/name/database">database</a>.  It manages the connection
and updates the local <a href="#//api/name/database">database</a> with the changes that have been made.  It is assumed
that address to the server and the name of the scripts in the DataConstants.h file
are correct.  NOTE:  Each time a request to push data to the server the manager makes
3 attempts to contact the server before giving up.  It has a 15 second timeout interval
so there may be the need to do some better reachability checks if battery consumption
is too much.</p>
					</div>
					
					
					
					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						<h2 class="subtitle subtitle-tasks">Tasks</h2>
						
						
						
						

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/database">&nbsp;&nbsp;database</a></code>
	</span>
	<span class="task-item-suffix">property</span>
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/patientID">&nbsp;&nbsp;patientID</a></code>
	</span>
	<span class="task-item-suffix">property</span>
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/currentRow">&nbsp;&nbsp;currentRow</a></code>
	</span>
	<span class="task-item-suffix">property</span>
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/_serverResponseData">&nbsp;&nbsp;_serverResponseData</a></code>
	</span>
	<span class="task-item-suffix">property</span>
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/failedAttempts">&nbsp;&nbsp;failedAttempts</a></code>
	</span>
	<span class="task-item-suffix">property</span>
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/remoteUnreachable">&nbsp;&nbsp;remoteUnreachable</a></code>
	</span>
	<span class="task-item-suffix">property</span>
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/initWithDatabase:">&ndash;&nbsp;initWithDatabase:</a></code>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/pushDataToRemoteServer">&ndash;&nbsp;pushDataToRemoteServer</a></code>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/sendRowToServer">&ndash;&nbsp;sendRowToServer</a></code>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/removeCurrentRowInLocalDB">&ndash;&nbsp;removeCurrentRowInLocalDB</a></code>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/URLEncodedString:">&ndash;&nbsp;URLEncodedString:</a></code>
	</span>
	
	
</li>
						</ul>
						
					</div>
					
					
					
					
					
					<div class="section section-methods">
						<a title="Properties" name="properties"></a>
						<h2 class="subtitle subtitle-methods">Properties</h2>
						
						<div class="section-method">
	<a name="//api/name/_serverResponseData" title="_serverResponseData"></a>
	<h3 class="subsubtitle method-title">_serverResponseData</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>The data buffer for the response from the server.  Used for determining the status
message from the server.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>@property (retain) NSMutableData *_serverResponseData</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/currentRow" title="currentRow"></a>
	<h3 class="subsubtitle method-title">currentRow</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>The first row selected from the <a href="#//api/name/database">database</a> as a result of a SQL statement.  It contains
the data needed for transmission to the server.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>@property (nonatomic) LocalDBResult *currentRow</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/database" title="database"></a>
	<h3 class="subsubtitle method-title">database</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>The database manager that will be used to retrieve data and send to the remote server.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>@property DBManager *database</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/failedAttempts" title="failedAttempts"></a>
	<h3 class="subsubtitle method-title">failedAttempts</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>The counter for the number of failed attempts.  The current limit is 3 times.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>@property NSInteger failedAttempts</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/patientID" title="patientID"></a>
	<h3 class="subsubtitle method-title">patientID</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>The patientID that is used for removing rows from the local <a href="#//api/name/database">database</a> as they are sent.
It is also used for the transmission of data to the remote server.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>@property NSInteger patientID</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/remoteUnreachable" title="remoteUnreachable"></a>
	<h3 class="subsubtitle method-title">remoteUnreachable</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>The flag used to determine if any more attempts should be made to the server after
the <a href="#//api/name/failedAttempts">failedAttempts</a> count has reached three times.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>@property BOOL remoteUnreachable</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
					</div>
					
					
					
					
					
					<div class="section section-methods">
						<a title="Instance Methods" name="instance_methods"></a>
						<h2 class="subtitle subtitle-methods">Instance Methods</h2>
						
						<div class="section-method">
	<a name="//api/name/URLEncodedString:" title="URLEncodedString:"></a>
	<h3 class="subsubtitle method-title">URLEncodedString:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>This is probably a bad hack.  This method is used to encode the string
into a URL suitable for the server.  It does not escape the ? = &amp; _ - / symbols.
It has been put into place because the default apple method for url encoding
a string with %encoding does not encode :&rsquo;s.  Unfortunately the datetime response
from the local <a href="#//api/name/database">database</a> includes colons.  Using the search and replace method
appears to has some undefined behavior and places extra escape sequences where none
are wanted or needed.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (NSString *)URLEncodedString:(NSString *)<em>utfString</em></code></div>

    
	
	<div class="method-subsection arguments-section parameters">
		<h4 class="method-subtitle parameter-title">Parameters</h4>
		
		<dl class="argument-def parameter-def">
			<dt><em>utfString</em></dt>
			<dd><p>The incoming string that will be utf8 encoded and then converted to a URL.</p></dd>
		</dl>
		
	</div>
	
	
	
	<div class="method-subsection return">
		<h4 class="method-subtitle parameter-title">Return Value</h4>
		<p>A NSString that is a new URL with % encoding.</p>
	</div>
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/initWithDatabase:" title="initWithDatabase:"></a>
	<h3 class="subsubtitle method-title">initWithDatabase:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>This method creates an instance using the <a href="#//api/name/database">database</a> manager that is passed to it.
This is the preferred method.  If no <a href="#//api/name/database">database</a> is given it will attempt to to
open the <a href="#//api/name/database">database</a> and assign it.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (id)initWithDatabase:(DBManager *)<em>datastore</em></code></div>

    
	
	<div class="method-subsection arguments-section parameters">
		<h4 class="method-subtitle parameter-title">Parameters</h4>
		
		<dl class="argument-def parameter-def">
			<dt><em>datastore</em></dt>
			<dd><p>The <a href="#//api/name/database">database</a> manager that is to be the source of data to send to
the server.</p></dd>
		</dl>
		
	</div>
	
	
	
	<div class="method-subsection return">
		<h4 class="method-subtitle parameter-title">Return Value</h4>
		<p>An instance of the remote server manager.</p>
	</div>
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/pushDataToRemoteServer" title="pushDataToRemoteServer"></a>
	<h3 class="subsubtitle method-title">pushDataToRemoteServer</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>This method is the wrapper method for the class.  It checks to see if the remote is
still reachable and that there is something to send to the server.  If the server
has been unreachable it ends.  If the server is reachable and the <a href="#//api/name/database">database</a> is empty
it ends, otherwise it continues going through the <a href="#//api/name/database">database</a> and pushing.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (void)pushDataToRemoteServer</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/removeCurrentRowInLocalDB" title="removeCurrentRowInLocalDB"></a>
	<h3 class="subsubtitle method-title">removeCurrentRowInLocalDB</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>This method removes the current row from the <a href="#//api/name/database">database</a>.  It is called after a successful
push to the remote server.  For our purposes, the local <a href="#//api/name/database">database</a> essentially functions
as a queue with an additional save state.  In case of application crash or phone crash,
etc the data is not lost and seemed easier to implement than a persistent data store.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (void)removeCurrentRowInLocalDB</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/sendRowToServer" title="sendRowToServer"></a>
	<h3 class="subsubtitle method-title">sendRowToServer</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>This method is the workhorse of the class. It retrieves the first first row from the
<a href="#//api/name/database">database</a>.  Then it creates a URL based on the data it retrieved.  Then it makes a
URL request to the server.  After that the NSURLConnection delete methods handle the
calls and continue the loop.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (void)sendRowToServer</code></div>

    
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">RemoteDBConnectionManager.h</code><br />
	</div>				
	
	
</div>
						
					</div>
					
					
                    
                    
                    
                    

				</div>
				<div class="main-navigation navigation-bottom">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2014 UHCL. All rights reserved. (Last updated: 2014-11-29)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2 (build 963)</a>.</span></p>
						
					</div>
				</div>
			</div>
		</article>
		<script type="text/javascript">
			function jumpToChange()
			{
				window.location.hash = this.options[this.selectedIndex].value;
			}
			
			function toggleTOC()
			{
				var contents = document.getElementById('contents');
				var tocContainer = document.getElementById('tocContainer');
				
				if (this.getAttribute('class') == 'open')
				{
					this.setAttribute('class', '');
					contents.setAttribute('class', '');
					tocContainer.setAttribute('class', '');
					
					window.name = "hideTOC";
				}
				else
				{
					this.setAttribute('class', 'open');
					contents.setAttribute('class', 'isShowingTOC');
					tocContainer.setAttribute('class', 'isShowingTOC');
					
					window.name = "";
				}
				return false;
			}
			
			function toggleTOCEntryChildren(e)
			{
				e.stopPropagation();
				var currentClass = this.getAttribute('class');
				if (currentClass == 'children') {
					this.setAttribute('class', 'children open');
				}
				else if (currentClass == 'children open') {
					this.setAttribute('class', 'children');
				}
				return false;
			}
			
			function tocEntryClick(e)
			{
				e.stopPropagation();
				return true;
			}
			
			function init()
			{
				var selectElement = document.getElementById('jumpTo');
				selectElement.addEventListener('change', jumpToChange, false);
				
				var tocButton = document.getElementById('table_of_contents');
				tocButton.addEventListener('click', toggleTOC, false);
				
				var taskTreeItem = document.getElementById('task_treeitem');
				if (taskTreeItem.getElementsByTagName('li').length > 0)
				{
					taskTreeItem.setAttribute('class', 'children');
					taskTreeItem.firstChild.setAttribute('class', 'disclosure');
				}
				
				var tocList = document.getElementById('toc');
				
				var tocEntries = tocList.getElementsByTagName('li');
				for (var i = 0; i < tocEntries.length; i++) {
					tocEntries[i].addEventListener('click', toggleTOCEntryChildren, false);
				}
				
				var tocLinks = tocList.getElementsByTagName('a');
				for (var i = 0; i < tocLinks.length; i++) {
					tocLinks[i].addEventListener('click', tocEntryClick, false);
				}
				
				if (window.name == "hideTOC") {
					toggleTOC.call(tocButton);
				}
			}
			
			window.onload = init;
			
			// If showing in Xcode, hide the TOC and Header
			if (navigator.userAgent.match(/xcode/i)) {
				document.getElementById("contents").className = "hideInXcode"
				document.getElementById("tocContainer").className = "hideInXcode"
				document.getElementById("top_header").className = "hideInXcode"
			}
			
		</script>
	</body>
</html>